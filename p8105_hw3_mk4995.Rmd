---
title: "Homework 3"
author: "Maya Krishnamoorthy"
date: "2024-10-06"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
```


## Problem 2

Load, tidy, merge, and otherwise organize the data sets. 
Your final dataset should include all originally observed variables
- exclude participants less than 21 years of age, and those with missing demographic data
- encode data with reasonable variable classes (i.e. not numeric, and using factors with the ordering of tables and plots in mind).

```{r organize}
accel_df = 
  read_csv("data/nhanes_accel.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(
    min1:min1440,
    names_to = "minute_interval",
    names_prefix = "min",
    values_to = "mims"
  )

covar_df = 
  read_csv("data/nhanes_covar.csv", skip = 4) |> 
  janitor::clean_names() |> 
  drop_na(sex, age, bmi, education) |> 
  filter(!(age < 21)) |> 
  mutate(
    sex = case_match(
      sex,
      1 ~ "Male",
      2 ~ "Female"
    ),
    education = case_match(
      education, 
      1 ~ "Less than high school",
      2 ~ "High school equivalent",
      3 ~ "More than high school"
    ),
    education = factor(
      education,
      levels = c("Less than high school", "High school equivalent", "More than high school")
    )
  )

merged_df = left_join(
  covar_df, 
  accel_df, 
  by = "seqn"
)
```


Produce a reader-friendly table for the number of men and women in each education category, and create a visualization of the age distributions for men and women in each education category. Comment on these items.

```{r}
merged_df |> 
  distinct(seqn, .keep_all = TRUE) |> 
  group_by(education, sex) |> 
  summarize(count = n()) |> 
  pivot_wider(
    names_from = sex,
    values_from = count
  ) |> 
  knitr::kable()

```



